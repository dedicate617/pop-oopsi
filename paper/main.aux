\relax 
\gdef \tocmax@section{18.00996pt}
\gdef \tocmax@subsection{14.01999pt}
\gdef \tocmax@subsubsection{12.84pt}
\gdef \tocmax@paragraph{5.0pt}
\gdef \tocmax@appendix{5.0pt}
\gdef \tocmax@pagenum{5.0pt}
\citation{??}
\citation{??}
\citation{??}
\citation{??}
\citation{??}
\citation{??}
\citation{??}
\citation{Tsien89}
\citation{??}
\citation{??}
\citation{??}
\citation{redshirt}
\citation{??}
\citation{??}
\citation{??}
\newlabel{FirstPage}{{}{1}{}{}{}}
\@writefile{toc}{\tocdepth@munge}
\@writefile{toc}{\contentsline {section}{\numberline {}Contents}{1}{}}
\@writefile{toc}{\tocdepth@restore}
\@writefile{toc}{\contentsline {section}{\numberline {I}Motivation}{1}{}}
\newlabel{intro}{{I}{1}{}{}{}}
\citation{BRIL88}
\citation{BRIL92}
\citation{CSK88}
\citation{KP06}
\citation{NYK06}
\citation{PAN04c}
\citation{PAN03d}
\citation{PILL07}
\citation{PG00}
\citation{Rigat06}
\citation{Stevenson2009}
\citation{TRUC05}
\citation{Vidne08}
\citation{PAN04c}
\citation{LD89}
\citation{PAN04c}
\citation{Escola07}
\citation{Vogelstein2009}
\@writefile{toc}{\contentsline {section}{\numberline {II}Methods}{2}{}}
\newlabel{sec:methods}{{II}{2}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {A}Model}{2}{}}
\newlabel{sec:methods:markov-setup}{{II\tmspace  +\thinmuskip {.1667em}A}{2}{}{}{}}
\newlabel{eqn:glm:definition}{{1}{2}{}{}{}}
\newlabel{eqn:h:definition}{{3}{2}{}{}{}}
\citation{Vogelstein2009}
\citation{Yasuda2004}
\citation{Vogelstein2009}
\citation{Rigat06}
\citation{DLR77}
\citation{McLachlanKrishnan96}
\citation{RAB89}
\newlabel{eqn:ca:definition}{{4}{3}{}{}{}}
\newlabel{eqn:F:definition}{{5}{3}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {B}Goal and general strategy}{3}{}}
\newlabel{sec:methods:goal}{{II\tmspace  +\thinmuskip {.1667em}B}{3}{}{}{}}
\citation{Vogelstein2009}
\citation{ShumwayStoffer06}
\citation{DFG01}
\citation{DGA00}
\citation{GDW04}
\citation{Vogelstein2009}
\newlabel{eqn:loglik:definition-expl}{{6}{4}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {C}Initialization of ``internal'' parameters via sequential Monte Carlo methods}{4}{}}
\newlabel{sec:methods:indep}{{II\tmspace  +\thinmuskip {.1667em}C}{4}{}{}{}}
\newlabel{eqn:forward}{{7}{4}{}{}{}}
\newlabel{eqn:backward}{{8}{4}{}{}{}}
\newlabel{eq:particle-fb}{{9}{4}{}{}{}}
\newlabel{eqn:bw}{{10}{4}{}{}{}}
\citation{BickelBengtsson08}
\citation{Andrieu2007}
\citation{NBR03}
\citation{NBR03}
\citation{NBR03}
\citation{NBR03}
\citation{Vogelstein2009}
\@writefile{toc}{\contentsline {subsection}{\numberline {D}Estimating joint posteriors over weakly coupled neurons}{5}{}}
\newlabel{sec:methods:joint}{{II\tmspace  +\thinmuskip {.1667em}D}{5}{}{}{}}
\citation{Binzegger04}
\citation{Buhl94}
\citation{Feldmeyer99}
\citation{FeldmeyerSakmann00}
\citation{Gupta00}
\citation{Mishchenko2009b}
\citation{PetersenSakmann00}
\citation{Reyes98}
\citation{Song2005}
\citation{Thompson88}
\citation{PAN04c}
\citation{PILL07}
\citation{Rigat06}
\citation{Stevenson08}
\citation{Candes2005}
\citation{DE03}
\citation{Mishchenko2009}
\citation{NG04}
\citation{Tibs96}
\citation{TIP01}
\citation{CONV04}
\@writefile{toc}{\contentsline {subsubsection}{\numberline {1}A cheaper high-SNR approximation of the joint posteriors}{6}{}}
\newlabel{sec:cheaper-high-snr}{{II\tmspace  +\thinmuskip {.1667em}D\tmspace  +\thinmuskip {.1667em}1}{6}{}{}{}}
\newlabel{eqn:indep_approx}{{13}{6}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {E}Estimating the functional connectivity matrix}{6}{}}
\newlabel{sec:methods:parameters HMM}{{II\tmspace  +\thinmuskip {.1667em}E}{6}{}{}{}}
\@writefile{toc}{\contentsline {subsubsection}{\numberline {1}Imposing a sparse prior on the functional connectivity}{6}{}}
\@writefile{toc}{\contentsline {subsubsection}{\numberline {2}Imposing Dale's law on the functional connectivity}{6}{}}
\citation{Vogelstein2009}
\@writefile{toc}{\contentsline {subsection}{\numberline {F}Specific implementation notes}{7}{}}
\newlabel{sec:methods:specific_implementation}{{II\tmspace  +\thinmuskip {.1667em}F}{7}{}{}{}}
\@writefile{loa}{\contentsline {algorithm}{\numberline {1}{\ignorespaces Pseudocode for estimating functional connectivity from calcium imaging data using EM; $\eta ^n$, $\eta ^F$, $N_G$ are user-defined convergence tolerance parameters. XXX CAN WE INDENT THE BELOW PROPERLY? WOULD MAKE IT MORE LEGIBLE XXX}}{7}{}}
\newlabel{eqn:pseudocode}{{1}{7}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {G}Accuracy of the estimates and Fisher information matrix}{7}{}}
\newlabel{sec:methods:accuracy_Fisher}{{II\tmspace  +\thinmuskip {.1667em}G}{7}{}{}{}}
\citation{Braitenberg1998}
\citation{Urquijo2000}
\citation{Lefort2009}
\citation{Sayer1990}
\citation{Braitenberg1998}
\citation{Urquijo2000}
\citation{Braitenberg1998}
\citation{Lefort2009}
\citation{Lefort2009}
\citation{Sayer1990}
\citation{Sayer1990}
\citation{Vogelstein2009}
\newlabel{eqn:fisher}{{16}{8}{}{}{}}
\@writefile{toc}{\contentsline {section}{\numberline {III}Results}{8}{}}
\newlabel{sec:results}{{III}{8}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {A}Simulating neural activity in a neural population}{8}{}}
\newlabel{sec:results:simulations}{{III\tmspace  +\thinmuskip {.1667em}A}{8}{}{}{}}
\newlabel{eqn:convert}{{18}{8}{}{}{}}
\@writefile{lot}{\contentsline {table}{\numberline {I}{\ignorespaces Table of simulation parameters.}}{9}{}}
\newlabel{table:caparm}{{I}{9}{}{}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {B}Inference of the functional connectivity from the simulated calcium imaging data}{9}{}}
\newlabel{sec:results:inference}{{III\tmspace  +\thinmuskip {.1667em}B}{9}{}{}{}}
\newlabel{eqn:likelihoodGLMmoda}{{19}{9}{}{}{}}
\newlabel{eqn:likelihoodGLMmodb}{{20}{9}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {1}{\ignorespaces A schematic depicting our data analysis pipeline. The left panel shows the mean image from an in vivo experiment, with regions-of-interest indicated by white circles, as determined by a custom algorithm (see Methods for details). By averaging the pixel intensity of all the pixels within a region of interest, we obtain a one-dimensional fluorescence trace for each neuron. The middle panel shows two such examples, the top showing a trace with relatively high signal-to-noise ratio (SNR), and the bottom showing a trace with a relatively low SNR. We use these signals to sample likely spike trains (below each trace), and use such joint spike trains to estimate the functional connectivity matrix, as shown in the left panel.}}{10}{}}
\newlabel{fig:data_example}{{1}{10}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {2}{\ignorespaces In calcium imaging a population of neural cells is continuously imaged using light microscopy and calcium sensitive fluorescent indicator (left panel). Whenever a neuron generates an action potential (fire), calcium influx through cellular membrane leads to a change in the fluorescence of the dye, thus allowing to detect the moments when cell fires (central panels). Accurate identification of spike trains from calcium imaging data gives access to detailed functional connectivity matrices for populations of neurons as large as 1,000 - 10,000 of cells.}}{10}{}}
\newlabel{fig:egfluor}{{2}{10}{}{}{}}
\citation{Vogelstein2009}
\newlabel{eqn:bias}{{21}{11}{}{}{}}
\@writefile{toc}{\contentsline {section}{\numberline {IV}Discussion}{12}{}}
\newlabel{sec:discussion}{{IV}{12}{}{}{}}
\@writefile{toc}{\contentsline {paragraph}{\numberline {a}j's outline of discussion}{12}{}}
\@writefile{toc}{\contentsline {paragraph}{\numberline {b}y's mini-discussion}{12}{}}
\bibdata{mybib}
\bibcite{Andrieu2007}{{1}{}{{}}{{}}}
\bibcite{BickelBengtsson08}{{2}{}{{}}{{}}}
\bibcite{Binzegger04}{{3}{}{{}}{{}}}
\bibcite{CONV04}{{4}{}{{}}{{}}}
\bibcite{Braitenberg1998}{{5}{}{{}}{{}}}
\bibcite{BRIL88}{{6}{}{{}}{{}}}
\bibcite{BRIL92}{{7}{}{{}}{{}}}
\bibcite{Buhl94}{{8}{}{{}}{{}}}
\bibcite{Candes2005}{{9}{}{{}}{{}}}
\bibcite{CSK88}{{10}{}{{}}{{}}}
\bibcite{DLR77}{{11}{}{{}}{{}}}
\bibcite{DE03}{{12}{}{{}}{{}}}
\bibcite{DFG01}{{13}{}{{}}{{}}}
\bibcite{DGA00}{{14}{}{{}}{{}}}
\bibcite{Escola07}{{15}{}{{}}{{}}}
\bibcite{Feldmeyer99}{{16}{}{{}}{{}}}
\bibcite{FeldmeyerSakmann00}{{17}{}{{}}{{}}}
\bibcite{GDW04}{{18}{}{{}}{{}}}
\bibcite{Urquijo2000}{{19}{}{{}}{{}}}
\@writefile{toc}{\contentsline {section}{\numberline {}Acknowledgments}{13}{}}
\@writefile{toc}{\contentsline {section}{\numberline {}References}{13}{}}
\bibcite{Gupta00}{{20}{}{{}}{{}}}
\bibcite{KP06}{{21}{}{{}}{{}}}
\bibcite{Lefort2009}{{22}{}{{}}{{}}}
\bibcite{LD89}{{23}{}{{}}{{}}}
\bibcite{McLachlanKrishnan96}{{24}{}{{}}{{}}}
\bibcite{Mishchenko2009}{{25}{}{{}}{{}}}
\bibcite{Mishchenko2009b}{{26}{}{{}}{{}}}
\bibcite{NBR03}{{27}{}{{}}{{}}}
\bibcite{NG04}{{28}{}{{}}{{}}}
\bibcite{NYK06}{{29}{}{{}}{{}}}
\bibcite{PAN04c}{{30}{}{{}}{{}}}
\bibcite{PAN03d}{{31}{}{{}}{{}}}
\bibcite{PetersenSakmann00}{{32}{}{{}}{{}}}
\bibcite{PILL07}{{33}{}{{}}{{}}}
\bibcite{PG00}{{34}{}{{}}{{}}}
\bibcite{RAB89}{{35}{}{{}}{{}}}
\bibcite{Reyes98}{{36}{}{{}}{{}}}
\bibcite{Rigat06}{{37}{}{{}}{{}}}
\bibcite{Sayer1990}{{38}{}{{}}{{}}}
\bibcite{ShumwayStoffer06}{{39}{}{{}}{{}}}
\bibcite{Song2005}{{40}{}{{}}{{}}}
\bibcite{Stevenson08}{{41}{}{{}}{{}}}
\bibcite{Stevenson2009}{{42}{}{{}}{{}}}
\bibcite{Thompson88}{{43}{}{{}}{{}}}
\bibcite{Tibs96}{{44}{}{{}}{{}}}
\bibcite{TIP01}{{45}{}{{}}{{}}}
\bibcite{TRUC05}{{46}{}{{}}{{}}}
\bibcite{Vidne08}{{47}{}{{}}{{}}}
\bibcite{Vogelstein2009}{{48}{}{{}}{{}}}
\bibcite{Yasuda2004}{{49}{}{{}}{{}}}
\global \chardef \firstnote@num49\relax 
\global\NAT@numberstrue
\bibstyle{amsplain}
\newlabel{LastBibItem}{{49}{14}{}{}{}}
\newlabel{LastPage}{{}{14}}
\@writefile{lof}{\contentsline {figure}{\numberline {3}{\ignorespaces Functional connectivity matrix can be reconstructed from calcium imaging data. In the upper panels inferred connection weights are shown in a scatter plot versus real connection weights, with inference performed using independent approximation algorithm, exact MCMC-Gibbs algorithm, and original spike trains observed at the frame-rate of the calcium imaging. Network of $N=25$ neurons was used, firing at 5 Hz, and imaged for T=600 sec at intermediate SNR (photon budget 10Kph/neuron/frame, see below). $r^2=0.47$ for independent approximation algorithm was found, $r^2=0.48$ for MCMC-Gibbs algorithm, and $r^2=0.57$ for the original spike trains. Thus, independent approximation produced results almost as accurate as the exact MCMC-Gibbs algorithm, and almost as accurate as the original spikes. Inferred connectivity weights (upper left) were scaled with respect to true connectivity by a constant amount due to time discretization bias (see below); other than scale, inferred connectivity represented the true connectivity matrix very well (upper right). Lower panels show the inferred histograms of the connection weights (dotted lines) versus that of the true connectivity matrix (think solid lines). Blue corresponds to negative (inhibitory) connections, red corresponds to positive (excitatory) connections, and black corresponds to zero (absent) connections in the true connectivity matrix. Thus, calcium imaging is sufficient to identify connected pairs of neurons reliably.}}{15}{}}
\newlabel{fig:scatters}{{3}{15}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {4}{\ignorespaces Low-frame rate of calcium imaging, leading to large bin size $\Delta \approx 15-30$ ms of the inferred spike trains, is the reason of scaling bias in the estimated connectivity matrix. This bias is explained well by considering what number of causally-related spikes from a pair of neurons are delayed by $\Delta $ or more, and so their temporal order can be reliably determined from calcium imaging data.}}{16}{}}
\newlabel{fig:bias}{{4}{16}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5}{\ignorespaces Accuracy of the inferred connectivity weights as function of the frame rate of calcium imaging. Connectivity matrix here was inferred from the original spike trains observed at corresponding frame-rates, thus establishing the upper performance bound for inference using calcium imaging data. A network of $N=25$ neurons, firing at 5 Hz and imaged for $T=600$ sec was used.}}{16}{}}
\newlabel{fig:recvar}{{5}{16}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {6}{\ignorespaces Accuracy of inferred connectivity weights as function of the noise amount in the calcium imaging data, as quantified by experimental photon budget per neuron-frame, for frame rates of 15 Hz, 33 Hz and 66 Hz. Photon counts on the order of 20-40 Kph/frame/neuron are required to achieve the upper bound due by the frame-rate. Connectivity matrix here was inferred from simulated fluorescence data using independent approximation algorithm. A network of $N=25$ neurons, firing at 5 Hz and imaged for $T=600$ sec was used.}}{17}{}}
\newlabel{fig:recvar-SNR}{{6}{17}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {7}{\ignorespaces Accuracy of inferred connectivity weights as function of the imaging time and neural population size. Incorporating simple priors such as exponential prior on the connectivity weights allows to boost reconstruction accuracy dramatically (dashed lines). In this latter case, $T=300$ sec is already sufficient to recover 70\% of the variance in the connection weights. Incorporating Dale's prior leads to only marginal improvement (dotted line). As shown in the methods, reconstruction accuracy does not depend on the neural population size $N$ (gray lines - light gray lines are for neural population size of $N=200$ neurons, dark gray line are for $N=100$ neurons and black lines are for $N=50$ neurons). $T=5$ min - 0.5 hour is sufficient to produce accurate reconstructions. }}{18}{}}
\newlabel{fig:recvar-NT}{{7}{18}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {8}{\ignorespaces  Diverseness of observed neural activity patterns is required for functional connectivity to give access to the actual ``anatomical'' structure of the neural circuit. Here, 15 sec of simulated spike trains for a weakly coupled network (upper-left) and a network with strongly coupled component (upper-right) are shown. In weakly coupled network spikes are sufficiently uncorrelated to give access to all different neural activity patterns needed to properly estimate true weights ${\bf  w}_i$. In strongly coupled case, many instances of highly synchronous locked firings are evident, thus preventing observation of sufficiently rich ensemble of activity patterns. Accordingly, GLM solution for the strongly coupled neural network (lower-right) does not represent the true connectivity of the circuit, even for the weakly coupled circuit's component. This is contrary to the weakly-coupled network (lower-left) where true connectivity is successfully estimated.}}{19}{}}
\newlabel{fig:rasters}{{8}{19}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {9}{\ignorespaces Bayesian inference algorithm is robust to distortions of the underlying generative model. One distortion that should be expected is variability of the EPSP time courses from neuron to neuron, and possibly synapse to synapse. With up to 25\% variability allowed in EPSP time scales $\tau _w$ (right panel) our algorithm provided reconstructions of the same quality as when all $\tau _w$ were the same (left panel).}}{20}{}}
\newlabel{fig:vartau}{{9}{20}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {10}{\ignorespaces Incorporating simple priors on the distribution of connectivity weights in the Bayesian inference algorithm, such as exponential sparseness prior, is essential to achieve much more accurate reconstructions than using simple GLM from a smaller amount of calcium imaging data. Here, connection weights reconstructed using simple GLM (left panel) or sparse-prior GLM (right panel) are shown in a scatter plot for a network of $N=50$ neurons firing at 5 Hz and imaged for T=600 sec. $r^2=0.64$ for simple GLM solution and $r^2=0.85$ for sparse-GLM solution.}}{21}{}}
\newlabel{fig:sparse}{{10}{21}{}{}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {11}{\ignorespaces Functional connectivity matrix inferred from a sample of actual calcium imaging data for $N=72$ cells in [XXX], imaged for $T\approx 260$ sec at 15 Hz. $N=23$ neurons with spikes at sufficient SNR were selected, and functional connectivity reconstructed using independent approximation algorithm. Firing cell of these cells was 0.1-1 Hz and 20-200 spikes were collected for each neuron. Upper-left panel shows example of actual fluorescence traces from selected cells, best to worst. Upper-right panel shows a raster of inferred spike trains for first 100 sec of imaging data. Lower panels show left-to-right the time-delayed cross-correlation matrix for selected neurons, simple GLM solution and sparse GLM solution, respectively. A consistent connectivity matrix is obtained here, with sparse solution having sparseness of $\approx 10 \%$, and all neurons automatically respecting Dale's law without explicitly enforcing it. Two clearly excitatory, and three clearly inhibitory neurons can be seen, with remaining neurons not showing significant couplings.}}{22}{}}
\newlabel{fig:real}{{11}{22}{}{}{}}
