Deducing the structure of neural circuits from neural activity is one of the central problems of modern neuroscience. Recent studies have examined this problem in the context of neural activity observations for dozens of neurons using multi-electrode techniques. Here, we present a model-based optimal approach for inferring structure of neural micro-circuits containing hundreds of neurons observed optically with calcium imaging. While calcium imaging allows less intrusive observations of neural activity in much larger populations than multi-electrode techniques, calcium imaging provides only indirect observations of neural spike trains, which often may have limited time resolution and signal quality.  To infer the functional connectivity matrix of neural micro-circuits from such indirect data, we assume a coupled hidden-Markov chain model, where each neuron is a generalized linear model.  The sufficient statistics of the cross-coupling terms, i.e. the functional connectivity matrix, are obtained using an embedded-chain-within-blockwise-Gibbs algorithm, which produces samples of joint spike trains of all observed neurons given the calcium traces. By introducing a factorized approximation for the likelihood of such joint spike trains, we are able to implement our algorithm in parallel on a high-performance cluster, without a significant degradation of inference results.  By imposing biophysically realistic constraints on our model, such as a sparseness of the connectivity matrix, we reduce the amount of data required to obtain a good fit.  Finally, using realistic simulation of spontaneous activity in a population of randomly connected neurons, we show that our method can successfully infer the connectivity patterns from $\sim 10$ minutes of calcium imaging data for neural populations up to $500$ neurons large, and is robust to deviations of real data from assumed generative model.
%Thus, this approach seems ready to be utilized by experimental neuroscientists to unravel the functional connectivity matrices underlying behavior and perception.
