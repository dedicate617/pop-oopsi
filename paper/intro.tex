Since Ramon y Cajal discovered that the brain is not a syncytium, but rather a rich and dense \emph{network} of neurons, neuroscientists have wondered about the details of these networks.  Since then, while much has been learned about ``macro-circuits''  --- the connectivity between populations of neurons --- relatively little is known about ``micro-circuits'' --- the connectivity within populations of neurons. Broadly, one can imagine two distinct strategies for inferring microcircuit connectivity: anatomical and functional.  

Anatomical approaches, while perhaps the gold standard for questions of connectivity, are often exceedingly laborious.  Historically, neuroanatomists used tracing studies to address these questions,  i.e., filled individual neurons with various dyes, and looked where the axons and dendrites terminated \cite{??}.  Besides being problematic with respect to whether the dyes filled the processes to the far proximal limit, or merely until the diameter became too small \cite{??}, this process is tedious and very low throughput.  Recently, experimentalists have developed fluorescent proteins that express throughout the dendritic tree \cite{??} or axonal arborization \cite{??}, that potentially resolves the premature termination issue, but not the throughput issue. Complementary to these labeling ideas, others have been developing Electron Microscopy based strategies to slice up neural tissue \cite{??}, and then automate track tracing using sophisticated image processing software \cite{??}.  This strategy has great promise for improving the throughput of these neuroanatomical studies, but have not yet quite achieved ``off-the-shelf'' status for experimental neuroscientists.  Combining these powerful microscopy/computational tools with the genetic sensors, is perhaps the most promising emerging technology to date, but would still require hundreds to thousands of computational hours to infer the microcircuit for even small populations of neurons, such as part of a retina \cite{??}.

While these neuroanatomical approaches are under development, complimentary functional approaches are also rapidly improving.  For instance, calcium-sensitive fluorescent indicators provide a glimpse into the spiking activity of neurons, in a relatively non-invasive manner \cite{Tsien89}. Very recently, some indicators achieve signal-to-noise ratios (SNRs) yielding single spike resolution \cite{??}.  In combination with these dyes, bulk-loading techniques enable experimentalists to simultaneously fill populations of neurons with such dyes \cite{??}.  While these approaches are state-of-the-art in terms of SNR, their invasiveness is a significant drawback.  To that end, genetically encoded calcium indicators are under rapid development from a number of groups, and they are approaching SNR levels of nearly single spike accuracy as well \cite{??}. Regardless of the source of the fluorescence, microscopy technologies for collecting the signal are also rapidly developing.  Cooled CCDs for wide-field imaging (either epifluorscence or confocal) now achieve a quantum efficiency of $\approx 90 \%$ with frame rates easily exceeding $30$ or $60$ Hz \cite{redshirt}.  For in vivo work, 2-photon laser scanning microscopy can achieve similar frame rates, by designing software to efficiently control the typical scanners \cite{??}, using acoustic-optical deflectors to focus light at arbitrary locations in (three-dimensional) space \cite{??}, or using resonant scanners \cite{??}.  Together, these experimental tools can provide movies 





Our aim here is to contribute a computational tool, that will enable one to infer the connectivity within a population of neurons, given only poor information regarding their activity.  





 through laborious neuroanatomical studies, the twenty-first century brings with it the possibility utilizing powerful technological advances to create high-throughput tools for asking quantitative neurobiological questions.  In particular, our aim here is to develop computational tools that facilitate inferring the functional connectivity between a population of observable neurons, using calcium-sensitive fluorescence sensors.

The problem of reconstructing connectivity in neural circuits in the brain has recently gained much attention \cite{Hagmann2008, Hagmann2007, Helmstaedter2009, DenkHorstmann04, Briggman2006, Ikegaya2005}. In particular, amid growing evidence of the importance of collective effects in neural networks \cite{Rabinovich2008, Broome2006, Jones2007}, the problem of understanding neural substrates of behavior and cognition via the structure of neural circuits had gradually moved into the spotlight of neuroscience research \cite{Averbeck2008, deBono2005, Song2005, Dunn2004, Chalasani2007, Gray2005, rswormatlas, White1986}.

Traditionally, one is interested in recovering the structure of neural circuit in the form of a wiring diagram specifying the list of synaptic connections in a particular population of neurons alongside with the synaptic connections' strengths and types. Few different approaches for such comprehensive reconstruction of neural circuits had been proposed in the past including serial section electron microscopy \cite{Briggman2006, Helmstaedter2009}, diffusion tensor imaging \cite{Hagmann2007, Hagmann2008}, ensembles of fluorescent tracers \cite{Bohland2009}, and others. Electron microscopy remains the standard for neuroanatomical circuits reconstruction with example of complete nervous system reconstruction in C. {\em elegans} available in the literature \cite{White1986, rswormatlas}. Electron microscopy, however, is known to be extremely expensive, slow and laborious method - reconstruction of the above mentioned circuit with only 300 neurons and fewer than $10^4$ connections took over a decade to complete. Even with recent developments in automated data acquisition \cite{DenkHorstmann04} and image-processing \cite{Mishchenko2009c, Jain2007, Jurrus2006}, electron microscopy remains an approach limited by long imaging times and extreme vulnerability to errors in neural tracing and image analysis. Diffusion tensor imaging \cite{Hagmann2007} and ensembles of fluorescent tracers \cite{Bohland2009} potentially offer a technique capable of much faster reconstructions and much larger circuits (also in live subjects in diffusion tensor imaging). However, low resolution of these techniques limits them to only the highest-level information about neural circuit organization, forgoing the fine details of neural connectivity. 

Although recently suggested method for collating information from ensembles of fluorescent markers using Compressive Sensing \cite{Mishchenko2009a, Mishchenko2009} may allow to overcome both the speed limitation of electron microscopy and resolution limit of optical techniques, this method requires development of novel genetic constructs and may be challenging to scale up to larger circuits. Overall, the problem of large scale reconstructions of the structure of neural circuits using neuroanatomy approach remains extremely challenging endeavor.


Another family of methods for inferring neural connectivity is using observations of neural activity in population of neurons, such as micro-electrodes recordings of external field potential \cite{Meister1994, Litke2003, Litke2004, PILL07, Stevenson2008} or functional magnetic resonance imaging (fMRI) [NEED REF]. Unlike the neuroanatomy approach, these techniques illuminate the structure of neural circuits in terms of their functional connectivity. Functional connectivity may be defined as the statistical effect one neuron's activity has upon another, i.e. two neurons are functionally connected if their spike trains are conditionally dependent given all the other observable variables, including the stimulus and the activity of all other neurons.Although details of the relationship between functional connectivity and anatomical circuit structure are yet to be elaborated, empirical knowledge of functional connectivity is important both fundamentally and for applications. Immediate knowledge of both functional and anatomical connectivity may be required to elucidate the relationship between the two, and also functional connectivity provides access to invaluable information about coding and decoding of signals in neural populations necessary for applications such as neural interfaces or neuro-prosthetics.

Despite their numerous advantages and many applications, both micro-electrode recordings and fMRI have also serious limitations. In case of external field recordings, application of this approach are limited by the size of largest micro-electrode arrays restricting the largest size of neural population that can be observed. Neural population with only $\leq 100$ cells can be simultaneously observed in state of the art experiments. fMRI, although potentially giving fast access to the entire brain in in-vivo conditions, is constrained by bad spatial and temporal resolution of fMRI signal, and uncertain relationship of fMRI signal (i.e. blood flow) with the neural activity.

Recently, great advances in the development of calcium indicators, delivery techniques, and microscopy technologies have facilitated calcium imaging of neural activity of large populations of neurons in a wide array of neural substrates \cite{Ikegaya2005, Nagayama2007, Nevian2007, Gobel07b}. Calcium imaging is an excellent tool for collecting large-scale data for functional connectivity, and is potentially capable of overcoming both the resolution limits of fMRI and population size limit of multi-electrode arrays. With calcium imaging, recordings at the level of individual cells are possible for thousands and tens of thousands of cells while retaining resolution sufficient for reconstruction of individual spikes \cite{Ikegaya2005}. In this paper we develop a Bayesian formalism for inferring neural connectivity in a population of neurons from such calcium imaging data.